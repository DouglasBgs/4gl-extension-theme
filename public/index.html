<body>
    <div class="container mt-4" id="center">
        <div class="row  mt-4">
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="codificacao" class="form-label">Issue de codificação</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="codificacao" placeholder="Nenhuma pasta selecionada"  onfocusout="verifica('codificacao','.rpo')"/>
                      <span style="color: red" id="teste21"></span>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="issue_tu" class="form-label">Issue de Teste Unitário</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="issue_tu" placeholder="Nenhuma pasta selecionada" />
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="issue_ti" class="form-label">Issue de Teste Integrado</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="issue_ti" placeholder="Nenhuma pasta selecionada" />
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="evidencia" class="form-label">Pasta com evidência de teste</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="evidencia" placeholder="Nenhuma pasta selecionada" />
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="arquivo_log_appserver" class="form-label">Arquivo de log do Servidor</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="arquivo_log_appserver"
                            placeholder="Necessário que o diretório termine com o arquivo .log" />
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="appserver" class="form-label">Arquivo AppServer</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="appserver" placeholder="Necessário que o diretório termine com o arquivo .lnk" />
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="tss" class="form-label">TSS</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="tss" placeholder="Necessário que o diretório termine com o arquivo .lnk" />
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="dbacess_tss" class="form-label">DB access TSS</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="dbacess_tss" placeholder="Necessário que o diretório termine com o arquivo .lnk" />
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="arquivos_romana" class="form-label">Servidor com fontes atualizados</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class=" inputPath col-md-12" id="arquivos_romana"
                            placeholder="Nenhum Arquivo selecionado" />
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row md-12">
                    <label for="rpo_local" class="form-label">destino do RPO em seu computador</label>
                </div>
                <div class="row md-12" title="Insira o caminho do seu diretório">
                    <div class="col-md-12 inputClass">
                        <input class="inputPath col-md-12" id="rpo_local" placeholder="Necessário que o diretório termine com o arquivo .rpo" />
                        <span class='rpo_local'></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="row md-12" style="text-align: center;">
                <label for="rpo_rede" class="form-label">RPOs Disponíveis para download</label>
            </div>
            <div class="col-md-6">
                <div class="row md-12" title="RPOs Disponíveis para download">
                    <div class="col-md-12 inputClass">
                        <select class="col-md-12" id='rpo_rede'>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row md-12">
                    <div class=" col-md-6">
                        <div class="col-md-12">
                            <button type="button" onclick="adicionarRPO()" id='adicionar'>Adicionar RPO</button>
                        </div>
                    </div>
                    <div class=" col-md-6 " style="text-align: end; font-size: 1rem;">
                        <button type="button"  onclick="deletarRPO()" id='deletar'>Deletar RPO</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="row md-12 mt-5 justify-content-center">
                <button type="button" class="save"  onclick="save()">Salvar Alterações</button>
        </div>
    </div>
</body>
<script>
const vscode = acquireVsCodeApi();
const codificacao = document.getElementById('codificacao');
const issue_tu = document.getElementById('issue_tu');
const issue_ti = document.getElementById('issue_ti');
const evidencia = document.getElementById('evidencia');
const arquivos_romana = document.getElementById('arquivos_romana');
const arquivo_log_appserver = document.getElementById('arquivo_log_appserver');
const appserver = document.getElementById('appserver');
const tss = document.getElementById('tss');
const dbacess_tss = document.getElementById('dbacess_tss');
const rpo_local = document.getElementById('rpo_local');


function save() {
    vscode.postMessage({
        command: 'save',
        values: {
        issue_codificacao: codificacao.value,
        issue_tu: issue_tu.value,
        issue_ti: issue_ti.value,
        evidencia: evidencia.value,
        arquivos_romana: arquivos_romana.value,
        arquivo_log_appserver: arquivo_log_appserver.value,
        appserver: appserver.value,
        tss: tss.value,
        dbacess_tss: dbacess_tss.value,
        rpo_local:rpo_local.value,
        rpo_rede: null
        }
    });
}

window.addEventListener('message', event => {
    const message = event.data; // The JSON data our extension sent
    switch (message.command) {
        case 'SelectedPath':
            codificacao.value = message.diretorios.issue_codificacao;
            issue_tu.value = message.diretorios.issue_tu;
            issue_ti.value = message.diretorios.issue_ti;
            evidencia.value = message.diretorios.evidencia;
            arquivos_romana.value = message.diretorios.arquivos_romana;
            arquivo_log_appserver.value = message.diretorios.arquivo_log_appserver;
            appserver.value = message.diretorios.appserver;
            tss.value = message.diretorios.tss;
            dbacess_tss.value = message.diretorios.dbacess_tss;
            rpo_local.value = message.diretorios.rpo_local;
            preencheRpo(message.diretorios.rpo_rede);

    }
});
window.onload = function () {
    vscode.postMessage({
        command: 'SelectPath',
    })
}
async function adicionarRPO() {
    await vscode.postMessage({
        command: 'adicionaRpo',
    })
}
async function deletarRPO() {
    await vscode.postMessage({
        command: 'deletaRpo',
    })
}

function preencheRpo(rpo_rede) {
    let elemento = document.getElementById("rpo_rede");
    while (elemento.firstChild) {
        elemento.removeChild(elemento.firstChild);
    }
    rpo_rede.forEach(rpo_rede => {
        const tag = document.createElement("option");
        const text = document.createTextNode(rpo_rede.name);
        tag.appendChild(text);
        let element = document.getElementById("rpo_rede");
        element.appendChild(tag);
    });

}


function verifica(elemento, extensao) {
   let verificaElemento = document.getElementById(elemento).value
   if(!validator.contains(verificaElemento,extensao)) {
//     vscode.postMessage({
//         command: 'message',
//         type: 'error',
//         values: 'TESTE'
//    } )
   console.log(false)
   }
}

</script>

</html>